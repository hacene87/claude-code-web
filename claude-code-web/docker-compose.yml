# Claude Code Web - Docker Compose Configuration
#
# This configuration runs the web interface and mounts the host's
# Claude Code CLI and home directory for seamless integration.
#
# Usage:
#   docker-compose up -d
#   docker-compose logs -f
#   docker-compose down

version: '3.8'

services:
  claude-code-web:
    build: .
    container_name: claude-code-web
    ports:
      - "8080:8080"
    volumes:
      # Mount home directory for workspace access
      - ${HOME}:/host-home:rw
      # Mount Claude Code CLI from host (adjust path as needed)
      - ${HOME}/.local/bin/claude:/usr/local/bin/claude:ro
      # Alternative: npm global
      # - ${HOME}/.npm-global/bin/claude:/usr/local/bin/claude:ro
      # Mount Claude Code configuration
      - ${HOME}/.claude:/root/.claude:rw
      - ${HOME}/.config/claude:/root/.config/claude:rw
      # Persist sessions
      - claude-web-sessions:/app/.claude-web-sessions
    environment:
      - HOST=0.0.0.0
      - PORT=8080
      # Pass through host's home for path resolution
      - HOST_HOME=${HOME}
    restart: unless-stopped
    # For development with live reload:
    # command: ["python", "-m", "uvicorn", "backend.main:app", "--host", "0.0.0.0", "--port", "8080", "--reload"]

volumes:
  claude-web-sessions:
    driver: local

# Alternative configuration without Docker (run directly on host):
#
# pip install -r requirements.txt
# cd backend && python main.py --host 127.0.0.1 --port 8080
